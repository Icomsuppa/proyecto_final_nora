========================================================
 INSTRUCCIONES DE USO - MICROSERVICIO FLASK (CHAT + HORA)
========================================================

ğŸ“ ESTRUCTURA RECOMENDADA DEL PROYECTO
--------------------------------------

flask_microservice/
â”œâ”€â”€ app.py
â”œâ”€â”€ config.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ blueprints/
â”‚   â”œâ”€â”€ time_bp.py
â”‚   â””â”€â”€ chat_bp.py
â”œâ”€â”€ static/
â”‚   â””â”€â”€ app.js
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ clients/
â”‚   â””â”€â”€ console_client.py
â””â”€â”€ instrucciones.txt


âš™ï¸ INSTALACIÃ“N Y CONFIGURACIÃ“N
-------------------------------

1. Crear entorno virtual (venv o pipenv):
   python -m venv venv
   pipenv install
   

2. Activar entorno:
   - En Windows: venv\Scripts\activate
   - En Linux/Mac: source venv/bin/activate

3. Instalar dependencias (si tienes pipenv, solo haz pipenv shell):
   pip install -r requirements.txt


ğŸš€ EJECUCIÃ“N DEL SERVIDOR
--------------------------

Para iniciar el servidor Flask:

   python app.py

El servidor se ejecutarÃ¡ en:
   http://0.0.0.0:5000/

Esto significa que estarÃ¡ disponible para cualquier equipo
de la misma red local (LAN).


ğŸŒ CONEXIÃ“N DESDE OTROS EQUIPOS EN LA RED
------------------------------------------

1. ObtÃ©n la direcciÃ³n IP local del servidor (donde ejecutaste Flask).
   Ejemplo:
       192.168.1.5

2. Desde cualquier otro equipo en la misma red, abre en el navegador:
       http://192.168.1.5:5000/

3. En la interfaz web:
   - Escribe tu nombre en el campo superior.
   - Pulsa **Conectar** para enlazarte al chat.
   - Escribe tus mensajes y presiona **Enviar**.
   - Puedes pulsar **Pedir hora (y comparar)** para recibir
     la hora del servidor y ver la diferencia con tu hora local.

4. Todos los usuarios conectados en la LAN verÃ¡n los mensajes compartidos.


ğŸ’¬ FUNCIONAMIENTO DEL CHAT MULTICAST
-------------------------------------

- El servidor envÃ­a y recibe mensajes en el grupo multicast:
     DirecciÃ³n: 224.1.1.1
     Puerto:    5007
     TTL:       1  (solo red local)

- Cada mensaje se reinyecta al sistema para que todos los
  clientes web conectados via SSE (Server-Sent Events)
  los reciban en tiempo real.

- Si varios servidores Flask estÃ¡n corriendo con esta
  configuraciÃ³n en la misma red, todos recibirÃ¡n y reenviarÃ¡n
  mensajes entre sÃ­ automÃ¡ticamente.


ğŸ’» CLIENTE DE CONSOLA (OPCIONAL)
---------------------------------

TambiÃ©n puedes usar el cliente de consola para solicitar la hora:

   python clients/console_client.py

Por defecto se conecta a:
   http://127.0.0.1:5000/time/

Si lo ejecutas desde otra mÃ¡quina, cambia la lÃ­nea en el script:

   URL = "http://<IP_DEL_SERVIDOR>:5000/time/"

Ejemplo:
   URL = "http://192.168.1.5:5000/time/"


ğŸ“¡ NOTAS TÃ‰CNICAS Y CONSIDERACIONES
------------------------------------

â€¢ Multicast en LAN:
  La direcciÃ³n 224.1.1.1:5007 y TTL=1 limitan la comunicaciÃ³n
  a la red local. AsegÃºrate de que tu router/switch permita
  multicast dentro de la misma subred.

â€¢ SSE (Server-Sent Events):
  Los navegadores se reconectan automÃ¡ticamente si la conexiÃ³n
  se interrumpe. El servidor mantiene una cola de mensajes
  (message_queue) y reenvÃ­a los nuevos en tiempo real.

â€¢ Seguridad y CORS:
  CORS estÃ¡ habilitado globalmente para facilitar pruebas LAN.
  En entornos de producciÃ³n se recomienda limitar los orÃ­genes.

â€¢ Escalado:
  Esta soluciÃ³n funciona bien en redes pequeÃ±as.
  Para redes grandes o clÃºsteres, usa un broker (Redis)
  o migra a WebSockets centralizados.

â€¢ Timeout:
  El cliente web y el cliente de consola usan un tiempo mÃ¡ximo
  de espera de 5 segundos (5000 ms) al solicitar la hora.


âœ… RESUMEN RÃPIDO
------------------

Servidor:
   python app.py

Cliente (desde navegador):
   http://<IP_DEL_SERVIDOR>:5000/

Cliente consola:
   python clients/console_client.py


Todos los equipos en la misma red local podrÃ¡n:
   - Enviar y recibir mensajes de chat en tiempo real.
   - Consultar y comparar la hora del servidor.
   - Intercambiar mensajes a travÃ©s de multicast LAN.

========================================================
